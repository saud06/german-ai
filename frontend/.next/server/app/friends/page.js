(()=>{var e={};e.id=89,e.ids=[89],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},595:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>c,routeModule:()=>g,tree:()=>o}),r(6184),r(6886),r(1930),r(5866);var s=r(3191),a=r(8716),i=r(7922),n=r.n(i),d=r(5231),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);r.d(t,l);let o=["",{children:["friends",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,6184)),"/Users/saud06/CascadeProjects/german-ai/frontend/src/app/friends/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,7026))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,6886)),"/Users/saud06/CascadeProjects/german-ai/frontend/src/app/layout.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,1930)),"/Users/saud06/CascadeProjects/german-ai/frontend/src/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,7026))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/saud06/CascadeProjects/german-ai/frontend/src/app/friends/page.tsx"],x="/friends/page",u={require:r,loadChunk:()=>Promise.resolve()},g=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/friends/page",pathname:"/friends",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},7641:(e,t,r)=>{Promise.resolve().then(r.bind(r,1879))},1879:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(326),a=r(9480),i=r(5047),n=r(2643);function d(){let e=(0,i.useRouter)(),[t,r]=(0,a.useState)([]),[d,l]=(0,a.useState)([]),[o,c]=(0,a.useState)([]),[x,u]=(0,a.useState)([]),[g,h]=(0,a.useState)(""),[m,p]=(0,a.useState)("friends"),[b,f]=(0,a.useState)(!0),[y,j]=(0,a.useState)(null);(0,a.useEffect)(()=>{v()},[]);let v=async()=>{let t=localStorage.getItem("token");if(!t){e.push("/login");return}try{let[e,s,a]=await Promise.all([fetch("http://localhost:8000/api/v1/friends/list",{headers:{Authorization:`Bearer ${t}`}}),fetch("http://localhost:8000/api/v1/friends/requests/incoming",{headers:{Authorization:`Bearer ${t}`}}),fetch("http://localhost:8000/api/v1/friends/requests/outgoing",{headers:{Authorization:`Bearer ${t}`}})]);e.ok&&r(await e.json()),s.ok&&l(await s.json()),a.ok&&c(await a.json()),f(!1)}catch(e){console.error("Failed to load friends data:",e),f(!1)}},k=async()=>{if(!g.trim())return;let e=localStorage.getItem("token");try{let t=await fetch(`http://localhost:8000/api/v1/friends/search?query=${encodeURIComponent(g)}`,{headers:{Authorization:`Bearer ${e}`}});t.ok&&(u(await t.json()),p("search"))}catch(e){console.error("Failed to search users:",e)}},N=async e=>{j(e);let t=localStorage.getItem("token");try{let r=await fetch("http://localhost:8000/api/v1/friends/request",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({to_user_id:e})});if(r.ok)alert("Friend request sent!"),await v(),await k();else{let e=await r.json();alert(e.detail||"Failed to send friend request")}}catch(e){console.error("Failed to send friend request:",e),alert("Failed to send friend request")}finally{j(null)}},w=async(e,t)=>{j(e);let r=localStorage.getItem("token");try{(await fetch("http://localhost:8000/api/v1/friends/request/respond",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({request_id:e,accept:t})})).ok&&(alert(t?"Friend request accepted!":"Friend request declined"),await v())}catch(e){console.error("Failed to respond to request:",e)}finally{j(null)}},q=async e=>{if(!confirm("Are you sure you want to remove this friend?"))return;j(e);let t=localStorage.getItem("token");try{(await fetch(`http://localhost:8000/api/v1/friends/remove/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}})).ok&&(alert("Friend removed"),await v())}catch(e){console.error("Failed to remove friend:",e)}finally{j(null)}};return b?(0,s.jsxs)(s.Fragment,{children:[s.jsx(n.default,{}),s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-zinc-950 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading friends..."})]})})]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(n.default,{}),s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-zinc-950 py-8",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto px-4",children:[(0,s.jsxs)("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold mb-2",children:"\uD83D\uDC65 Friends & Social"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Connect with other learners, compete on leaderboards, and motivate each other"})]}),(0,s.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg border p-4 mb-6",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"\uD83D\uDCA1 How Friends Work"}),(0,s.jsxs)("ul",{className:"text-sm space-y-1 text-gray-700 dark:text-gray-300",children:[(0,s.jsxs)("li",{children:["• ",s.jsx("strong",{children:"Search"})," for users by email to send friend requests"]}),(0,s.jsxs)("li",{children:["• ",s.jsx("strong",{children:"Accept"})," incoming requests to add them as friends"]}),(0,s.jsxs)("li",{children:["• ",s.jsx("strong",{children:"Compete"})," with friends on leaderboards and challenges"]}),(0,s.jsxs)("li",{children:["• ",s.jsx("strong",{children:"Track"})," each other's progress, streaks, and achievements"]}),(0,s.jsxs)("li",{children:["• ",s.jsx("strong",{children:"Motivate"})," each other to maintain daily streaks"]})]})]}),s.jsx("div",{className:"mb-6",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:g,onChange:e=>h(e.target.value),onKeyPress:e=>"Enter"===e.key&&k(),placeholder:"Search users by email...",className:"flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-zinc-800 dark:border-zinc-700"}),s.jsx("button",{onClick:k,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Search"})]})}),(0,s.jsxs)("div",{className:"flex gap-4 mb-6 border-b border-gray-200 dark:border-zinc-800",children:[(0,s.jsxs)("button",{onClick:()=>p("friends"),className:`px-4 py-2 font-medium transition-colors border-b-2 ${"friends"===m?"border-indigo-600 text-indigo-600":"border-transparent text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200"}`,children:["Friends (",t.length,")"]}),(0,s.jsxs)("button",{onClick:()=>p("requests"),className:`px-4 py-2 font-medium transition-colors border-b-2 relative ${"requests"===m?"border-indigo-600 text-indigo-600":"border-transparent text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200"}`,children:["Requests (",d.length+o.length,")",d.length>0&&s.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:d.length})]}),(0,s.jsxs)("button",{onClick:()=>p("search"),className:`px-4 py-2 font-medium transition-colors border-b-2 ${"search"===m?"border-indigo-600 text-indigo-600":"border-transparent text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200"}`,children:["Search Results (",x.length,")"]})]}),"friends"===m&&s.jsx("div",{className:"space-y-4",children:0===t.length?(0,s.jsxs)("div",{className:"text-center py-12 bg-white dark:bg-zinc-900 rounded-lg border",children:[s.jsx("div",{className:"text-6xl mb-4",children:"\uD83D\uDC65"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No friends yet"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Search for users by email and send friend requests"})]}):t.map(e=>(0,s.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-12 w-12 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center",children:s.jsx("span",{className:"text-xl font-bold text-indigo-600",children:(e.name||e.email).charAt(0).toUpperCase()})}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-semibold",children:e.name||e.email}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Level ",e.level," • ",e.total_xp," XP • ",e.current_streak," day streak"]}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["Friends since ",new Date(e.friends_since).toLocaleDateString()]})]})]}),s.jsx("button",{onClick:()=>q(e.user_id),disabled:y===e.user_id,className:"px-4 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg disabled:opacity-50",children:"Remove"})]},e.user_id))}),"requests"===m&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Incoming Requests"}),0===d.length?s.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center py-8 bg-white dark:bg-zinc-900 rounded-lg border",children:"No incoming requests"}):s.jsx("div",{className:"space-y-3",children:d.map(e=>(0,s.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-semibold",children:e.from_name||e.from_email}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Sent ",new Date(e.created_at).toLocaleDateString()]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>w(e.request_id,!0),disabled:y===e.request_id,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:"Accept"}),s.jsx("button",{onClick:()=>w(e.request_id,!1),disabled:y===e.request_id,className:"px-4 py-2 bg-gray-200 dark:bg-zinc-800 rounded-lg hover:bg-gray-300 dark:hover:bg-zinc-700 disabled:opacity-50",children:"Decline"})]})]},e.request_id))})]}),(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Outgoing Requests"}),0===o.length?s.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center py-8 bg-white dark:bg-zinc-900 rounded-lg border",children:"No outgoing requests"}):s.jsx("div",{className:"space-y-3",children:o.map(e=>(0,s.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-semibold",children:e.to_name||e.to_email}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Sent ",new Date(e.created_at).toLocaleDateString()]})]}),s.jsx("span",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:"Pending"})]},e.request_id))})]})]}),"search"===m&&s.jsx("div",{className:"space-y-4",children:0===x.length?(0,s.jsxs)("div",{className:"text-center py-12 bg-white dark:bg-zinc-900 rounded-lg border",children:[s.jsx("div",{className:"text-6xl mb-4",children:"\uD83D\uDD0D"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No results"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Try searching by email address"})]}):x.map(e=>(0,s.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"h-12 w-12 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center",children:s.jsx("span",{className:"text-xl font-bold text-indigo-600",children:(e.name||e.email).charAt(0).toUpperCase()})}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-semibold",children:e.name||e.email}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Level ",e.level," ",e.total_xp&&`• ${e.total_xp} XP`]})]})]}),s.jsx("div",{children:e.is_friend?s.jsx("span",{className:"px-4 py-2 bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-400 rounded-lg text-sm",children:"✓ Friends"}):e.request_pending?s.jsx("span",{className:"px-4 py-2 bg-yellow-100 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-400 rounded-lg text-sm",children:"Pending"}):s.jsx("button",{onClick:()=>N(e.user_id),disabled:y===e.user_id,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:"Add Friend"})})]},e.user_id))})]})})]})}},2643:(e,t,r)=>{"use strict";r.d(t,{default:()=>n});var s=r(4597),a=r(6591),i=r(5047);function n(){let{token:e}=(0,a.a)(),t=(0,i.useRouter)();return(0,s.useEffect)(()=>{try{e||t.replace("/login")}catch{e||t.replace("/login")}},[e,t]),null}},6184:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>d});var s=r(8570);let a=(0,s.createProxy)(String.raw`/Users/saud06/CascadeProjects/german-ai/frontend/src/app/friends/page.tsx`),{__esModule:i,$$typeof:n}=a;a.default;let d=(0,s.createProxy)(String.raw`/Users/saud06/CascadeProjects/german-ai/frontend/src/app/friends/page.tsx#default`)},7026:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var s=r(6621);let a=e=>[{type:"image/svg+xml",sizes:"any",url:(0,s.fillMetadataSegment)(".",e.params,"icon.svg")+"?d88cf511049578a4"}]}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,102,621,871],()=>r(595));module.exports=s})();