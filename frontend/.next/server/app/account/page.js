(()=>{var e={};e.id=346,e.ids=[346],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},896:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c}),t(6147),t(6886),t(1930),t(5866);var s=t(3191),a=t(8716),i=t(7922),n=t.n(i),l=t(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(r,o);let c=["",{children:["account",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,6147)),"/Users/saud06/CascadeProjects/german-ai/frontend/src/app/account/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,7026))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,6886)),"/Users/saud06/CascadeProjects/german-ai/frontend/src/app/layout.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,1930)),"/Users/saud06/CascadeProjects/german-ai/frontend/src/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,7026))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/Users/saud06/CascadeProjects/german-ai/frontend/src/app/account/page.tsx"],u="/account/page",x={require:t,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/account/page",pathname:"/account",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},4214:(e,r,t)=>{Promise.resolve().then(t.bind(t,5560))},5560:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>l});var s=t(326),a=t(9480),i=t(5047),n=t(2643);function l(){let e=(0,i.useRouter)(),[r,t]=(0,a.useState)("subscription"),[l,o]=(0,a.useState)(null),[c,d]=(0,a.useState)(null),[u,x]=(0,a.useState)(!0),[p,g]=(0,a.useState)(!1);(0,a.useEffect)(()=>{m()},[]);let m=async()=>{try{let r=localStorage.getItem("token");if(!r){e.push("/login");return}let t=await fetch("http://localhost:8000/api/v1/payments/subscription",{headers:{Authorization:`Bearer ${r}`}});if(t.ok){let e=await t.json();o(e)}let s=await fetch("http://localhost:8000/api/v1/referrals/stats",{headers:{Authorization:`Bearer ${r}`}});if(s.ok){let e=await s.json();d(e)}}catch(e){console.error("Failed to fetch account data:",e)}finally{x(!1)}},h=async e=>{if("free"!==e){g(!0);try{let r=localStorage.getItem("token"),t=await fetch("http://localhost:8000/api/v1/payments/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({tier:e,success_url:`${window.location.origin}/account?success=true`,cancel_url:`${window.location.origin}/account`,trial_days:l?.tier==="free"?14:void 0})});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.detail||"Failed to create checkout session")}let s=await t.json();s.checkout_url&&(window.location.href=s.checkout_url)}catch(r){console.error("Upgrade error:",r);let e=r.message||"Failed to start checkout";e.includes("Stripe")?alert("Payment system is not fully configured. Please contact support."):alert(e)}finally{g(!1)}}},f=async()=>{g(!0);try{let e=localStorage.getItem("token");(await fetch("http://localhost:8000/api/v1/referrals/generate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}})).ok&&await m()}catch(e){console.error("Failed to generate referral code:",e),alert("Failed to generate referral code")}finally{g(!1)}};return u?(0,s.jsxs)(s.Fragment,{children:[s.jsx(n.default,{}),s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-zinc-950 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading account..."})]})})]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(n.default,{}),s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-zinc-950 py-8",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto px-4",children:[(0,s.jsxs)("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Account & Billing"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage your subscription, billing, and referrals"})]}),(0,s.jsxs)("div",{className:"flex gap-4 mb-6 border-b border-gray-200 dark:border-zinc-800",children:[s.jsx("button",{onClick:()=>t("subscription"),className:`px-4 py-2 font-medium transition-colors border-b-2 ${"subscription"===r?"border-indigo-600 text-indigo-600":"border-transparent text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200"}`,children:"\uD83D\uDCB3 Subscription & Pricing"}),s.jsx("button",{onClick:()=>t("referrals"),className:`px-4 py-2 font-medium transition-colors border-b-2 ${"referrals"===r?"border-indigo-600 text-indigo-600":"border-transparent text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200"}`,children:"\uD83C\uDF81 Referrals & Rewards"})]}),"subscription"===r&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-6",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Current Plan"}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-2xl font-bold capitalize",children:l?.tier||"Free"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Status: ",s.jsx("span",{className:"capitalize",children:l?.status||"Active"})]}),l?.current_period_end&&(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[l.cancel_at_period_end?"Cancels":"Renews"," on"," ",new Date(l.current_period_end).toLocaleDateString()]})]}),l?.tier!=="free"&&s.jsx("button",{className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200 border rounded-lg",onClick:()=>alert("Manage billing via Stripe Customer Portal (to be implemented)"),children:"Manage Billing"})]})]}),(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Available Plans"}),s.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:[{id:"free",name:"Free",price:0,interval:"forever",features:["5 AI conversations per day","Basic vocabulary (500 words)","Grammar lessons","Public quizzes","Community support"]},{id:"premium",name:"Premium",price:999,interval:"month",popular:!0,features:["Unlimited AI conversations","Full vocabulary (5000+ words)","Advanced grammar","Unlimited quizzes","Voice chat","Spaced repetition","Priority support"]},{id:"plus",name:"Plus",price:1999,interval:"month",features:["Everything in Premium","Business German","Certification prep","Custom learning paths","Advanced analytics","API access","1-on-1 tutoring (2h/month)"]}].map(e=>(0,s.jsxs)("div",{className:`relative bg-white dark:bg-zinc-900 rounded-lg border p-6 ${e.popular?"ring-2 ring-indigo-600":""}`,children:[e.popular&&s.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 bg-indigo-600 text-white px-3 py-1 rounded-full text-xs font-semibold",children:"Most Popular"}),(0,s.jsxs)("div",{className:"mb-4",children:[s.jsx("h3",{className:"text-xl font-bold",children:e.name}),s.jsx("div",{className:"mt-2",children:0===e.price?s.jsx("span",{className:"text-3xl font-bold",children:"Free"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"text-3xl font-bold",children:["$",(e.price/100).toFixed(0)]}),(0,s.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:["/",e.interval]})]})})]}),s.jsx("ul",{className:"space-y-2 mb-6",children:e.features.map((e,r)=>(0,s.jsxs)("li",{className:"flex items-start gap-2 text-sm",children:[s.jsx("span",{className:"text-green-500 mt-0.5",children:"✓"}),s.jsx("span",{children:e})]},r))}),s.jsx("button",{onClick:()=>h(e.id),disabled:l?.tier===e.id||p,className:`w-full py-2 rounded-lg font-medium transition ${l?.tier===e.id?"bg-gray-200 dark:bg-zinc-800 text-gray-600 dark:text-gray-400 cursor-not-allowed":e.popular?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-100 dark:bg-zinc-800 hover:bg-gray-200 dark:hover:bg-zinc-700"}`,children:l?.tier===e.id?"Current Plan":"free"===e.id?"Downgrade":l?.tier==="free"?"Start 14-day Trial":"Upgrade"})]},e.id))})]})]}),"referrals"===r&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-6",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Your Referral Code"}),c?.code?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex-1 bg-gray-100 dark:bg-zinc-800 rounded-lg p-4 font-mono text-lg",children:c.code}),s.jsx("button",{onClick:()=>{if(c?.code){let e=`${window.location.origin}/register?ref=${c.code}`;navigator.clipboard.writeText(e),alert("Referral link copied to clipboard!")}},className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Copy Link"})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Share this link with friends. When they sign up using your link, you both get rewards!"}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[s.jsx("p",{children:s.jsx("strong",{children:"How it works:"})}),(0,s.jsxs)("ol",{className:"list-decimal list-inside space-y-1 mt-2",children:[s.jsx("li",{children:"Share your referral link with friends"}),s.jsx("li",{children:"They click the link and register for an account"}),s.jsx("li",{children:"Once they complete their first lesson, you both get rewards"}),s.jsx("li",{children:"Earn bonus XP, coins, and unlock exclusive features"})]})]})]}):(0,s.jsxs)("div",{className:"text-center py-8",children:[s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"You don't have a referral code yet"}),s.jsx("button",{onClick:f,disabled:p,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:p?"Generating...":"Generate Referral Code"})]})]}),c&&(0,s.jsxs)("div",{className:"grid md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-4",children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Referrals"}),s.jsx("p",{className:"text-2xl font-bold",children:c.total_referrals})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-4",children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Successful"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:c.successful_referrals})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-4",children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Pending"}),s.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:c.pending_referrals})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-4",children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Rewards"}),(0,s.jsxs)("p",{className:"text-2xl font-bold text-indigo-600",children:[c.total_rewards," XP"]})]})]}),(0,s.jsxs)("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 rounded-lg border p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-3",children:"\uD83C\uDF81 Referral Rewards"}),(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsxs)("p",{children:["• ",s.jsx("strong",{children:"100 XP"})," for each successful referral"]}),(0,s.jsxs)("p",{children:["• ",s.jsx("strong",{children:"50 Coins"})," when your friend completes their first lesson"]}),(0,s.jsxs)("p",{children:["• ",s.jsx("strong",{children:"Bonus rewards"})," for every 5 successful referrals"]}),(0,s.jsxs)("p",{children:["• ",s.jsx("strong",{children:"Exclusive badges"})," for top referrers"]})]})]})]})]})})]})}},2643:(e,r,t)=>{"use strict";t.d(r,{default:()=>n});var s=t(4597),a=t(6591),i=t(5047);function n(){let{token:e}=(0,a.a)(),r=(0,i.useRouter)();return(0,s.useEffect)(()=>{try{e||r.replace("/login")}catch{e||r.replace("/login")}},[e,r]),null}},6147:(e,r,t)=>{"use strict";t.r(r),t.d(r,{$$typeof:()=>n,__esModule:()=>i,default:()=>l});var s=t(8570);let a=(0,s.createProxy)(String.raw`/Users/saud06/CascadeProjects/german-ai/frontend/src/app/account/page.tsx`),{__esModule:i,$$typeof:n}=a;a.default;let l=(0,s.createProxy)(String.raw`/Users/saud06/CascadeProjects/german-ai/frontend/src/app/account/page.tsx#default`)},7026:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});var s=t(6621);let a=e=>[{type:"image/svg+xml",sizes:"any",url:(0,s.fillMetadataSegment)(".",e.params,"icon.svg")+"?d88cf511049578a4"}]}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[948,102,621,871],()=>t(896));module.exports=s})();