(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{3899:function(e,t,r){Promise.resolve().then(r.bind(r,4237))},6463:function(e,t,r){"use strict";var a=r(1169);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},3196:function(e,t,r){"use strict";r.d(t,{d4:function(){return a.useEffect}});var a=r(1196)},6202:function(e,t,r){"use strict";r.d(t,{d4:function(){return a.useEffect},eJ:function(){return a.useState}});var a=r(1196)},4492:function(e,t,r){"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a=r(1196),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=a.useState,i=a.useEffect,l=a.useLayoutEffect,o=a.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!n(e,r)}catch(e){return!0}}var d="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),a=s({inst:{value:r,getSnapshot:t}}),n=a[0].inst,d=a[1];return l(function(){n.value=r,n.getSnapshot=t,c(n)&&d({inst:n})},[e,r,t]),i(function(){return c(n)&&d({inst:n}),e(function(){c(n)&&d({inst:n})})},[e]),o(r),r};t.useSyncExternalStore=void 0!==a.useSyncExternalStore?a.useSyncExternalStore:d},5107:function(e,t,r){"use strict";/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a=r(1196),n=r(554),s="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=n.useSyncExternalStore,l=a.useRef,o=a.useEffect,c=a.useMemo,d=a.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,r,a,n){var u=l(null);if(null===u.current){var g={hasValue:!1,value:null};u.current=g}else g=u.current;var m=i(e,(u=c(function(){function e(e){if(!o){if(o=!0,i=e,e=a(e),void 0!==n&&g.hasValue){var t=g.value;if(n(t,e))return l=t}return l=e}if(t=l,s(i,e))return t;var r=a(e);return void 0!==n&&n(t,r)?t:(i=e,l=r)}var i,l,o=!1,c=void 0===r?null:r;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,r,a,n]))[0],u[1]);return o(function(){g.hasValue=!0,g.value=m},[m]),d(m),m}},554:function(e,t,r){"use strict";e.exports=r(4492)},5006:function(e,t,r){"use strict";e.exports=r(5107)},4237:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var a=r(3619),n=r(6202),s=r(6463),i=r(9002);function l(){let e=(0,s.useRouter)(),[t,r]=(0,n.eJ)("subscription"),[l,o]=(0,n.eJ)(null),[c,d]=(0,n.eJ)(null),[u,g]=(0,n.eJ)(!0),[m,h]=(0,n.eJ)(!1);(0,n.d4)(()=>{x()},[]);let x=async()=>{try{let t=localStorage.getItem("token");if(!t){e.push("/login");return}let r=await fetch("http://localhost:8000/api/v1/payments/subscription",{headers:{Authorization:"Bearer ".concat(t)}});if(r.ok){let e=await r.json();o(e)}let a=await fetch("http://localhost:8000/api/v1/referrals/stats",{headers:{Authorization:"Bearer ".concat(t)}});if(a.ok){let e=await a.json();d(e)}}catch(e){console.error("Failed to fetch account data:",e)}finally{g(!1)}},f=async e=>{if("free"!==e){h(!0);try{let t=localStorage.getItem("token"),r=await fetch("http://localhost:8000/api/v1/payments/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({tier:e,success_url:"".concat(window.location.origin,"/account?success=true"),cancel_url:"".concat(window.location.origin,"/account"),trial_days:(null==l?void 0:l.tier)==="free"?14:void 0})});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error(e.detail||"Failed to create checkout session")}let a=await r.json();a.checkout_url&&(window.location.href=a.checkout_url)}catch(t){console.error("Upgrade error:",t);let e=t.message||"Failed to start checkout";e.includes("Stripe")?alert("Payment system is not fully configured. Please contact support."):alert(e)}finally{h(!1)}}},p=async()=>{h(!0);try{let e=localStorage.getItem("token");(await fetch("http://localhost:8000/api/v1/referrals/generate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}})).ok&&await x()}catch(e){console.error("Failed to generate referral code:",e),alert("Failed to generate referral code")}finally{h(!1)}};return u?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.default,{}),(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-zinc-950 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading account..."})]})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.default,{}),(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-zinc-950 py-8",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-4",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Account & Billing"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage your subscription, billing, and referrals"})]}),(0,a.jsxs)("div",{className:"flex gap-4 mb-6 border-b border-gray-200 dark:border-zinc-800",children:[(0,a.jsx)("button",{onClick:()=>r("subscription"),className:"px-4 py-2 font-medium transition-colors border-b-2 ".concat("subscription"===t?"border-indigo-600 text-indigo-600":"border-transparent text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200"),children:"\uD83D\uDCB3 Subscription & Pricing"}),(0,a.jsx)("button",{onClick:()=>r("referrals"),className:"px-4 py-2 font-medium transition-colors border-b-2 ".concat("referrals"===t?"border-indigo-600 text-indigo-600":"border-transparent text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200"),children:"\uD83C\uDF81 Referrals & Rewards"})]}),"subscription"===t&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Current Plan"}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold capitalize",children:(null==l?void 0:l.tier)||"Free"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Status: ",(0,a.jsx)("span",{className:"capitalize",children:(null==l?void 0:l.status)||"Active"})]}),(null==l?void 0:l.current_period_end)&&(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[l.cancel_at_period_end?"Cancels":"Renews"," on"," ",new Date(l.current_period_end).toLocaleDateString()]})]}),(null==l?void 0:l.tier)!=="free"&&(0,a.jsx)("button",{className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200 border rounded-lg",onClick:()=>alert("Manage billing via Stripe Customer Portal (to be implemented)"),children:"Manage Billing"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Available Plans"}),(0,a.jsx)("div",{className:"grid md:grid-cols-3 gap-6",children:[{id:"free",name:"Free",price:0,interval:"forever",features:["5 AI conversations per day","Basic vocabulary (500 words)","Grammar lessons","Public quizzes","Community support"]},{id:"premium",name:"Premium",price:999,interval:"month",popular:!0,features:["Unlimited AI conversations","Full vocabulary (5000+ words)","Advanced grammar","Unlimited quizzes","Voice chat","Spaced repetition","Priority support"]},{id:"plus",name:"Plus",price:1999,interval:"month",features:["Everything in Premium","Business German","Certification prep","Custom learning paths","Advanced analytics","API access","1-on-1 tutoring (2h/month)"]}].map(e=>(0,a.jsxs)("div",{className:"relative bg-white dark:bg-zinc-900 rounded-lg border p-6 ".concat(e.popular?"ring-2 ring-indigo-600":""),children:[e.popular&&(0,a.jsx)("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 bg-indigo-600 text-white px-3 py-1 rounded-full text-xs font-semibold",children:"Most Popular"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-bold",children:e.name}),(0,a.jsx)("div",{className:"mt-2",children:0===e.price?(0,a.jsx)("span",{className:"text-3xl font-bold",children:"Free"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"text-3xl font-bold",children:["$",(e.price/100).toFixed(0)]}),(0,a.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:["/",e.interval]})]})})]}),(0,a.jsx)("ul",{className:"space-y-2 mb-6",children:e.features.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-start gap-2 text-sm",children:[(0,a.jsx)("span",{className:"text-green-500 mt-0.5",children:"✓"}),(0,a.jsx)("span",{children:e})]},t))}),(0,a.jsx)("button",{onClick:()=>f(e.id),disabled:(null==l?void 0:l.tier)===e.id||m,className:"w-full py-2 rounded-lg font-medium transition ".concat((null==l?void 0:l.tier)===e.id?"bg-gray-200 dark:bg-zinc-800 text-gray-600 dark:text-gray-400 cursor-not-allowed":e.popular?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-100 dark:bg-zinc-800 hover:bg-gray-200 dark:hover:bg-zinc-700"),children:(null==l?void 0:l.tier)===e.id?"Current Plan":"free"===e.id?"Downgrade":(null==l?void 0:l.tier)==="free"?"Start 14-day Trial":"Upgrade"})]},e.id))})]})]}),"referrals"===t&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Your Referral Code"}),(null==c?void 0:c.code)?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"flex-1 bg-gray-100 dark:bg-zinc-800 rounded-lg p-4 font-mono text-lg",children:c.code}),(0,a.jsx)("button",{onClick:()=>{if(null==c?void 0:c.code){let e="".concat(window.location.origin,"/register?ref=").concat(c.code);navigator.clipboard.writeText(e),alert("Referral link copied to clipboard!")}},className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Copy Link"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Share this link with friends. When they sign up using your link, you both get rewards!"}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:"How it works:"})}),(0,a.jsxs)("ol",{className:"list-decimal list-inside space-y-1 mt-2",children:[(0,a.jsx)("li",{children:"Share your referral link with friends"}),(0,a.jsx)("li",{children:"They click the link and register for an account"}),(0,a.jsx)("li",{children:"Once they complete their first lesson, you both get rewards"}),(0,a.jsx)("li",{children:"Earn bonus XP, coins, and unlock exclusive features"})]})]})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"You don't have a referral code yet"}),(0,a.jsx)("button",{onClick:p,disabled:m,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:m?"Generating...":"Generate Referral Code"})]})]}),c&&(0,a.jsxs)("div",{className:"grid md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Referrals"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:c.total_referrals})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Successful"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:c.successful_referrals})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Pending"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:c.pending_referrals})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Rewards"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-indigo-600",children:[c.total_rewards," XP"]})]})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 rounded-lg border p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"\uD83C\uDF81 Referral Rewards"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"100 XP"})," for each successful referral"]}),(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"50 Coins"})," when your friend completes their first lesson"]}),(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"Bonus rewards"})," for every 5 successful referrals"]}),(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"Exclusive badges"})," for top referrers"]})]})]})]})]})})]})}},9002:function(e,t,r){"use strict";r.d(t,{default:function(){return i}});var a=r(3196),n=r(8588),s=r(6463);function i(){let{token:e}=(0,n.a)(),t=(0,s.useRouter)();return(0,a.d4)(()=>{try{let r=localStorage.getItem("token");e||r||t.replace("/login")}catch(r){e||t.replace("/login")}},[e,t]),null}},8588:function(e,t,r){"use strict";let a;r.d(t,{a:function(){return m}});let n=e=>{let t;let r=new Set,a=(e,a)=>{let n="function"==typeof e?e(t):e;if(!Object.is(n,t)){let e=t;t=(null!=a?a:"object"!=typeof n||null===n)?n:Object.assign({},t,n),r.forEach(r=>r(t,e))}},n=()=>t,s={setState:a,getState:n,getInitialState:()=>i,subscribe:e=>(r.add(e),()=>r.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},i=t=e(a,n,s);return s},s=e=>e?n(e):n;var i=r(1196),l=r(5006);let{useDebugValue:o}=i,{useSyncExternalStoreWithSelector:c}=l,d=!1,u=e=>e,g=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?s(e):e,r=(e,r)=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u,r=arguments.length>2?arguments[2]:void 0;r&&!d&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),d=!0);let a=c(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return o(a),a})(t,e,r);return Object.assign(r,t),r},m=(a=e=>({token:localStorage.getItem("token"),userId:localStorage.getItem("user_id"),name:localStorage.getItem("user_name"),email:localStorage.getItem("user_email"),setAuth:(t,r)=>{localStorage.setItem("token",t),localStorage.setItem("user_id",r),e({token:t,userId:r})},setProfile:(t,r)=>{try{localStorage.setItem("user_name",t),localStorage.setItem("user_email",r)}catch(e){}e({name:t,email:r})},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user_id"),localStorage.removeItem("user_name"),localStorage.removeItem("user_email"),e({token:null,userId:null,name:null,email:null})}}))?g(a):g}},function(e){e.O(0,[971,23,744],function(){return e(e.s=3899)}),_N_E=e.O()}]);