(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[89],{463:function(e,t,r){Promise.resolve().then(r.bind(r,9612))},6463:function(e,t,r){"use strict";var s=r(1169);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},3196:function(e,t,r){"use strict";r.d(t,{d4:function(){return s.useEffect}});var s=r(1196)},6202:function(e,t,r){"use strict";r.d(t,{d4:function(){return s.useEffect},eJ:function(){return s.useState}});var s=r(1196)},4492:function(e,t,r){"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s=r(1196),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=s.useState,i=s.useEffect,o=s.useLayoutEffect,l=s.useDebugValue;function d(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!n(e,r)}catch(e){return!0}}var c="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),s=a({inst:{value:r,getSnapshot:t}}),n=s[0].inst,c=s[1];return o(function(){n.value=r,n.getSnapshot=t,d(n)&&c({inst:n})},[e,r,t]),i(function(){return d(n)&&c({inst:n}),e(function(){d(n)&&c({inst:n})})},[e]),l(r),r};t.useSyncExternalStore=void 0!==s.useSyncExternalStore?s.useSyncExternalStore:c},5107:function(e,t,r){"use strict";/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s=r(1196),n=r(554),a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=n.useSyncExternalStore,o=s.useRef,l=s.useEffect,d=s.useMemo,c=s.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,r,s,n){var u=o(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;var g=i(e,(u=d(function(){function e(e){if(!l){if(l=!0,i=e,e=s(e),void 0!==n&&h.hasValue){var t=h.value;if(n(t,e))return o=t}return o=e}if(t=o,a(i,e))return t;var r=s(e);return void 0!==n&&n(t,r)?t:(i=e,o=r)}var i,o,l=!1,d=void 0===r?null:r;return[function(){return e(t())},null===d?void 0:function(){return e(d())}]},[t,r,s,n]))[0],u[1]);return l(function(){h.hasValue=!0,h.value=g},[g]),c(g),g}},554:function(e,t,r){"use strict";e.exports=r(4492)},5006:function(e,t,r){"use strict";e.exports=r(5107)},9612:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var s=r(3619),n=r(6202),a=r(6463),i=r(9002);function o(){let e=(0,a.useRouter)(),[t,r]=(0,n.eJ)([]),[o,l]=(0,n.eJ)([]),[d,c]=(0,n.eJ)([]),[u,h]=(0,n.eJ)([]),[g,m]=(0,n.eJ)(""),[x,f]=(0,n.eJ)("friends"),[b,p]=(0,n.eJ)(!0),[y,v]=(0,n.eJ)(null);(0,n.d4)(()=>{j()},[]);let j=async()=>{let t=localStorage.getItem("token");if(!t){e.push("/login");return}try{let[e,s,n]=await Promise.all([fetch("http://localhost:8000/api/v1/friends/list",{headers:{Authorization:"Bearer ".concat(t)}}),fetch("http://localhost:8000/api/v1/friends/requests/incoming",{headers:{Authorization:"Bearer ".concat(t)}}),fetch("http://localhost:8000/api/v1/friends/requests/outgoing",{headers:{Authorization:"Bearer ".concat(t)}})]);e.ok&&r(await e.json()),s.ok&&l(await s.json()),n.ok&&c(await n.json()),p(!1)}catch(e){console.error("Failed to load friends data:",e),p(!1)}},k=async()=>{if(!g.trim())return;let e=localStorage.getItem("token");try{let t=await fetch("http://localhost:8000/api/v1/friends/search?query=".concat(encodeURIComponent(g)),{headers:{Authorization:"Bearer ".concat(e)}});t.ok&&(h(await t.json()),f("search"))}catch(e){console.error("Failed to search users:",e)}},N=async e=>{v(e);let t=localStorage.getItem("token");try{let r=await fetch("http://localhost:8000/api/v1/friends/request",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({to_user_id:e})});if(r.ok)alert("Friend request sent!"),await j(),await k();else{let e=await r.json();alert(e.detail||"Failed to send friend request")}}catch(e){console.error("Failed to send friend request:",e),alert("Failed to send friend request")}finally{v(null)}},w=async(e,t)=>{v(e);let r=localStorage.getItem("token");try{(await fetch("http://localhost:8000/api/v1/friends/request/respond",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({request_id:e,accept:t})})).ok&&(alert(t?"Friend request accepted!":"Friend request declined"),await j())}catch(e){console.error("Failed to respond to request:",e)}finally{v(null)}},S=async e=>{if(!confirm("Are you sure you want to remove this friend?"))return;v(e);let t=localStorage.getItem("token");try{(await fetch("http://localhost:8000/api/v1/friends/remove/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok&&(alert("Friend removed"),await j())}catch(e){console.error("Failed to remove friend:",e)}finally{v(null)}};return b?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.default,{}),(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-zinc-950 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading friends..."})]})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.default,{}),(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-zinc-950 py-8",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto px-4",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"\uD83D\uDC65 Friends & Social"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Connect with other learners, compete on leaderboards, and motivate each other"})]}),(0,s.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg border p-4 mb-6",children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"\uD83D\uDCA1 How Friends Work"}),(0,s.jsxs)("ul",{className:"text-sm space-y-1 text-gray-700 dark:text-gray-300",children:[(0,s.jsxs)("li",{children:["• ",(0,s.jsx)("strong",{children:"Search"})," for users by email to send friend requests"]}),(0,s.jsxs)("li",{children:["• ",(0,s.jsx)("strong",{children:"Accept"})," incoming requests to add them as friends"]}),(0,s.jsxs)("li",{children:["• ",(0,s.jsx)("strong",{children:"Compete"})," with friends on leaderboards and challenges"]}),(0,s.jsxs)("li",{children:["• ",(0,s.jsx)("strong",{children:"Track"})," each other's progress, streaks, and achievements"]}),(0,s.jsxs)("li",{children:["• ",(0,s.jsx)("strong",{children:"Motivate"})," each other to maintain daily streaks"]})]})]}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:g,onChange:e=>m(e.target.value),onKeyPress:e=>"Enter"===e.key&&k(),placeholder:"Search users by email...",className:"flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-zinc-800 dark:border-zinc-700"}),(0,s.jsx)("button",{onClick:k,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Search"})]})}),(0,s.jsxs)("div",{className:"flex gap-4 mb-6 border-b border-gray-200 dark:border-zinc-800",children:[(0,s.jsxs)("button",{onClick:()=>f("friends"),className:"px-4 py-2 font-medium transition-colors border-b-2 ".concat("friends"===x?"border-indigo-600 text-indigo-600":"border-transparent text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200"),children:["Friends (",t.length,")"]}),(0,s.jsxs)("button",{onClick:()=>f("requests"),className:"px-4 py-2 font-medium transition-colors border-b-2 relative ".concat("requests"===x?"border-indigo-600 text-indigo-600":"border-transparent text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200"),children:["Requests (",o.length+d.length,")",o.length>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:o.length})]}),(0,s.jsxs)("button",{onClick:()=>f("search"),className:"px-4 py-2 font-medium transition-colors border-b-2 ".concat("search"===x?"border-indigo-600 text-indigo-600":"border-transparent text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200"),children:["Search Results (",u.length,")"]})]}),"friends"===x&&(0,s.jsx)("div",{className:"space-y-4",children:0===t.length?(0,s.jsxs)("div",{className:"text-center py-12 bg-white dark:bg-zinc-900 rounded-lg border",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDC65"}),(0,s.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"No friends yet"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Search for users by email and send friend requests"})]}):t.map(e=>(0,s.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-xl font-bold text-indigo-600",children:(e.name||e.email).charAt(0).toUpperCase()})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold",children:e.name||e.email}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Level ",e.level," • ",e.total_xp," XP • ",e.current_streak," day streak"]}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["Friends since ",new Date(e.friends_since).toLocaleDateString()]})]})]}),(0,s.jsx)("button",{onClick:()=>S(e.user_id),disabled:y===e.user_id,className:"px-4 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg disabled:opacity-50",children:"Remove"})]},e.user_id))}),"requests"===x&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Incoming Requests"}),0===o.length?(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-center py-8 bg-white dark:bg-zinc-900 rounded-lg border",children:"No incoming requests"}):(0,s.jsx)("div",{className:"space-y-3",children:o.map(e=>(0,s.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold",children:e.from_name||e.from_email}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Sent ",new Date(e.created_at).toLocaleDateString()]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>w(e.request_id,!0),disabled:y===e.request_id,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:"Accept"}),(0,s.jsx)("button",{onClick:()=>w(e.request_id,!1),disabled:y===e.request_id,className:"px-4 py-2 bg-gray-200 dark:bg-zinc-800 rounded-lg hover:bg-gray-300 dark:hover:bg-zinc-700 disabled:opacity-50",children:"Decline"})]})]},e.request_id))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Outgoing Requests"}),0===d.length?(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-center py-8 bg-white dark:bg-zinc-900 rounded-lg border",children:"No outgoing requests"}):(0,s.jsx)("div",{className:"space-y-3",children:d.map(e=>(0,s.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold",children:e.to_name||e.to_email}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Sent ",new Date(e.created_at).toLocaleDateString()]})]}),(0,s.jsx)("span",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:"Pending"})]},e.request_id))})]})]}),"search"===x&&(0,s.jsx)("div",{className:"space-y-4",children:0===u.length?(0,s.jsxs)("div",{className:"text-center py-12 bg-white dark:bg-zinc-900 rounded-lg border",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDD0D"}),(0,s.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"No results"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Try searching by email address"})]}):u.map(e=>(0,s.jsxs)("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-xl font-bold text-indigo-600",children:(e.name||e.email).charAt(0).toUpperCase()})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold",children:e.name||e.email}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Level ",e.level," ",e.total_xp&&"• ".concat(e.total_xp," XP")]})]})]}),(0,s.jsx)("div",{children:e.is_friend?(0,s.jsx)("span",{className:"px-4 py-2 bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-400 rounded-lg text-sm",children:"✓ Friends"}):e.request_pending?(0,s.jsx)("span",{className:"px-4 py-2 bg-yellow-100 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-400 rounded-lg text-sm",children:"Pending"}):(0,s.jsx)("button",{onClick:()=>N(e.user_id),disabled:y===e.user_id,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:"Add Friend"})})]},e.user_id))})]})})]})}},9002:function(e,t,r){"use strict";r.d(t,{default:function(){return i}});var s=r(3196),n=r(8588),a=r(6463);function i(){let{token:e}=(0,n.a)(),t=(0,a.useRouter)();return(0,s.d4)(()=>{try{let r=localStorage.getItem("token");e||r||t.replace("/login")}catch(r){e||t.replace("/login")}},[e,t]),null}},8588:function(e,t,r){"use strict";let s;r.d(t,{a:function(){return g}});let n=e=>{let t;let r=new Set,s=(e,s)=>{let n="function"==typeof e?e(t):e;if(!Object.is(n,t)){let e=t;t=(null!=s?s:"object"!=typeof n||null===n)?n:Object.assign({},t,n),r.forEach(r=>r(t,e))}},n=()=>t,a={setState:s,getState:n,getInitialState:()=>i,subscribe:e=>(r.add(e),()=>r.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},i=t=e(s,n,a);return a},a=e=>e?n(e):n;var i=r(1196),o=r(5006);let{useDebugValue:l}=i,{useSyncExternalStoreWithSelector:d}=o,c=!1,u=e=>e,h=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?a(e):e,r=(e,r)=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u,r=arguments.length>2?arguments[2]:void 0;r&&!c&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),c=!0);let s=d(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return l(s),s})(t,e,r);return Object.assign(r,t),r},g=(s=e=>({token:localStorage.getItem("token"),userId:localStorage.getItem("user_id"),name:localStorage.getItem("user_name"),email:localStorage.getItem("user_email"),setAuth:(t,r)=>{localStorage.setItem("token",t),localStorage.setItem("user_id",r),e({token:t,userId:r})},setProfile:(t,r)=>{try{localStorage.setItem("user_name",t),localStorage.setItem("user_email",r)}catch(e){}e({name:t,email:r})},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user_id"),localStorage.removeItem("user_name"),localStorage.removeItem("user_email"),e({token:null,userId:null,name:null,email:null})}}))?h(s):h}},function(e){e.O(0,[971,23,744],function(){return e(e.s=463)}),_N_E=e.O()}]);